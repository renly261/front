(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{b49e:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{staticClass:"q-pa-xl",attrs:{id:"favorite"}},[r("q-table",{attrs:{title:"",data:t.favorite,columns:t.columns,"row-key":"_id",filter:t.filter,grid:"","hide-header":""},scopedSlots:t._u([{key:"top-right",fn:function(){return[r("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:t._u([{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]},proxy:!0},{key:"item",fn:function(e){return[r("div",{staticClass:"q-pa-md col-xs-12 col-md-6"},[r("q-card",[r("q-card-section",{staticClass:"row"},[r("div",{staticClass:"col-12 flex justify-center"},[r("q-img",{attrs:{src:e.row.image}})],1),r("div",{staticClass:"col-12 flex justify-center"},[r("h5",{staticClass:"text-center"},[t._v(t._s(e.row.name))])])]),r("q-card-section",{staticClass:"row",staticStyle:{width:"100%"}},[r("div",{staticClass:"col-6 flex justify-center"},[r("q-btn",{attrs:{rounded:"",icon:"delete",label:"取消收藏"},on:{click:function(r){return t.delFavorite(e.rowIndex)}}})],1),r("div",{staticClass:"col-6 flex justify-center"},[r("q-btn",{attrs:{rounded:"",icon:"add_shopping_cart",label:"加入購物車",state:t.amountstate},on:{click:function(r){return t.addcart(e.rowIndex)}}})],1)]),r("q-separator",{staticClass:"row q-my-md"}),r("q-card-section",{staticClass:"row",attrs:{id:"info"}},[r("div",{staticClass:"col-12"},[r("div",{staticClass:"text-body1 flex text-left"},[t._v(t._s(e.row.description))])])])],1)],1)]}}])})],1)},n=[],o=r("ded3"),s=r.n(o),i=r("c973"),c=r.n(i),u=(r("96cf"),r("b0c0"),r("a434"),r("d81d"),r("99af"),{name:"Favorite",data:function(){return{filter:"",favorite:[],amount:1,columns:[{name:"name",required:!0,label:"name",align:"left",field:function(t){return t.name},format:function(t){return"".concat(t)},sortable:!1},{name:"amount",label:"amount",field:"amount",sortable:!0},{name:"price",label:"price",field:"price"}]}},computed:{amountstate:function(){return 0===this.amount?null:this.amount>0}},methods:{addcart:function(t){var e=this;return c()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.amountstate){r.next=3;break}return e.$swal({icon:"error",title:"錯誤",text:"商品數量必須 > 0"}),r.abrupt("return");case 3:if(0!==e.$store.state.user.jwt.token.length){r.next=6;break}return e.$swal({icon:"error",title:"錯誤",text:"請先登入"}),r.abrupt("return");case 6:return r.prev=6,r.next=9,e.axios.post("/users/cart",{product:e.favorite[t]._id,amount:e.amount},{headers:{authorization:"Bearer "+e.$store.state.user.jwt.token}});case 9:e.$swal({icon:"success",title:"成功",text:"成功加入購物車"}),r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](6),e.$swal({icon:"error",title:"錯誤",text:"加入購物車失敗"}),console.log(r.t0);case 16:case"end":return r.stop()}}),r,null,[[6,12]])})))()},delFavorite:function(t){var e=this;return c()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.axios.patch("/users/favorite",{product:e.favorite[t]._id,amount:0},{headers:{authorization:"Bearer "+e.$store.state.user.jwt.token}});case 3:e.favorite.splice(t,1),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"刪除商品失敗"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()}},mounted:function(){var t=this;return c()(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,0!==t.$store.state.user.jwt.token.length){e.next=5;break}return t.$swal({icon:"error",title:"錯誤",text:"請先登入"}),"/"!==t.$route.path&&t.$router.push("/"),e.abrupt("return");case 5:return e.next=7,t.axios.get("/users/favorite",{headers:{authorization:"Bearer "+t.$store.state.user.jwt.token}});case 7:r=e.sent,a=r.data,console.log(a.result),t.favorite=a.result.map((function(t){return t=s()(s()({},t.product),{},{amount:t.amount}),t.image="".concat("","/files/").concat(t.image),t.edit=!1,t.amountModel=t.amount,t})),t.favorite.length<1&&t.$swal({title:"目前收藏清單沒有東西，是否要去商品頁面 ?",icon:"question",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"前往商品頁面",denyButtonText:"不用了，謝謝"}).then((function(e){e.isConfirmed?t.$swal("快來加入你要收藏或比較的商品吧","","success",t.$router.push("/adminProduct")):e.isDenied&&t.$swal("感謝您","","success",t.$router.push("/"))})),e.next=16;break;case 14:e.prev=14,e.t0=e["catch"](0);case 16:case"end":return e.stop()}}),e,null,[[0,14]])})))()}}),l=u,d=r("2877"),f=r("9989"),p=r("eaac"),m=r("27f9"),h=r("0016"),w=r("f09f"),x=r("a370"),v=r("068f"),b=r("9c40"),g=r("eb85"),k=r("eebe"),$=r.n(k),q=Object(d["a"])(l,a,n,!1,null,null,null);e["default"]=q.exports;$()(q,"components",{QPage:f["a"],QTable:p["a"],QInput:m["a"],QIcon:h["a"],QCard:w["a"],QCardSection:x["a"],QImg:v["a"],QBtn:b["a"],QSeparator:g["a"]})}}]);