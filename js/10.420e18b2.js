(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{6515:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{id:"adminProductManage"}},[a("div",{staticClass:"row q-pa-xl"},[a("div",{staticClass:"col"},[a("q-table",{attrs:{title:"商品編輯",data:e.products,columns:e.columns,"row-key":"_id",filter:e.filter,"binary-state-sort":""},scopedSlots:e._u([{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-td",{key:"name",staticClass:"cursor-pointer",attrs:{props:t},on:{click:function(a){return e.editProduct(t.rowIndex)}}},[e._v(e._s(t.row.name)),a("q-popup-edit",{attrs:{title:"商品名稱",anchor:"top start"},model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"props.row.name"}},[a("q-form",[a("q-input",{attrs:{dense:"",autofocus:"",counter:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",outline:""}})],1)],1)],1),a("q-td",{key:"description",staticClass:"cursor-pointer",attrs:{id:"description",props:t},on:{click:function(a){return e.editProduct(t.rowIndex)}}},[e._v("點我編輯"),a("q-popup-edit",{attrs:{title:"商品說明",anchor:"top start"},model:{value:t.row.description,callback:function(a){e.$set(t.row,"description",a)},expression:"props.row.description"}},[a("q-form",[a("q-input",{attrs:{dense:"",autofocus:"",counter:"",type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",outline:""}})],1)],1)],1),a("q-td",{key:"detail",staticClass:"cursor-pointer",attrs:{id:"detail",props:t},on:{click:function(a){return e.editProduct(t.rowIndex)}}},[e._v("點我編輯"),a("q-popup-edit",{attrs:{title:"商品規格",anchor:"top start"},model:{value:t.row.detail,callback:function(a){e.$set(t.row,"detail",a)},expression:"props.row.detail"}},[a("q-form",[a("q-input",{attrs:{dense:"",autofocus:"",counter:"",type:"textarea"},model:{value:e.form.detail,callback:function(t){e.$set(e.form,"detail",t)},expression:"form.detail"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",outline:""}})],1)],1)],1),a("q-td",{key:"price",staticClass:"cursor-pointer",attrs:{props:t},on:{click:function(a){return e.editProduct(t.rowIndex)}}},[e._v(e._s(t.row.price)),a("q-popup-edit",{attrs:{title:"商品價格",anchor:"top right"},model:{value:t.row.price,callback:function(a){e.$set(t.row,"price",a)},expression:"props.row.price"}},[a("q-form",[a("q-input",{attrs:{dense:"",autofocus:"",counter:"",type:"number"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",outline:""}})],1)],1)],1),a("q-td",{key:"brand",staticClass:"cursor-pointer",attrs:{props:t},on:{click:function(a){return e.editProduct(t.rowIndex)}}},[e._v(e._s(t.row.brand)),a("q-popup-edit",{attrs:{title:"商品品牌",anchor:"top start"},model:{value:t.row.brand,callback:function(a){e.$set(t.row,"brand",a)},expression:"props.row.brand"}},[a("q-form",[a("q-select",{staticClass:"q-mb-md",attrs:{outlined:"",options:e.brand,label:"商品品牌"},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",outline:""}})],1)],1)],1),a("q-td",{key:"cate",staticClass:"cursor-pointer",attrs:{props:t},on:{click:function(a){return e.editProduct(t.rowIndex)}}},[e._v(e._s(t.row.cate)),a("q-popup-edit",{attrs:{title:"商品類別",anchor:"top start"},model:{value:t.row.cate,callback:function(a){e.$set(t.row,"cate",a)},expression:"props.row.cate"}},[a("q-form",[a("q-select",{staticClass:"q-mb-md",attrs:{outlined:"",options:e.cate,label:"商品品牌"},model:{value:e.form.cate,callback:function(t){e.$set(e.form,"cate",t)},expression:"form.cate"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",outline:""}})],1)],1)],1),a("q-td",{key:"image",attrs:{props:t},on:{click:function(a){return e.editProduct(t.rowIndex)}}},[a("img",{staticClass:"cursor-pointer",staticStyle:{height:"100px",width:"100px"},attrs:{src:t.row.image}}),a("q-popup-edit",{attrs:{title:"商品圖片",anchor:"top right"},model:{value:t.row.image,callback:function(a){e.$set(t.row,"image",a)},expression:"props.row.image"}},[a("q-form",[a("img-inputer",{attrs:{theme:"dark",size:"large",placeholder:"點擊或拖曳選擇圖片","bottom-text":"點擊或拖曳以修改"},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}}),a("div",{staticClass:"text-center"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",outline:""}})],1)],1)],1)],1),a("q-td",{key:"sell",staticClass:"cursor-pointer",attrs:{props:t},on:{click:function(a){return e.editProduct(t.rowIndex)}}},[t.row.sell?a("div",{staticClass:"text-body"},[e._v("上架中")]):e._e(),t.row.sell?e._e():a("div",{staticClass:"text-body"},[e._v("下架中")]),a("q-popup-edit",{attrs:{title:"商品上下架",anchor:"top left"},model:{value:t.row.sell,callback:function(a){e.$set(t.row,"sell",a)},expression:"props.row.sell"}},[a("q-form",[a("q-btn-toggle",{attrs:{rounded:"","no-caps":"",unelevated:"","toggle-color":"primary",options:[{label:"上架",value:"true"},{label:"下架",value:"false"}]},model:{value:e.form.sell,callback:function(t){e.$set(e.form,"sell",t)},expression:"form.sell"}}),a("div",{staticClass:"q-mt-md text-center"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",outline:""}})],1)],1)],1)],1)],1)]}},{key:"top-right",fn:function(){return[a("q-btn",{staticClass:"q-mr-xl",attrs:{color:"primary",disable:e.loading,label:"新增商品"},on:{click:function(t){e.add=!0}}}),a("q-dialog",{model:{value:e.add,callback:function(t){e.add=t},expression:"add"}},[a("q-card",{staticClass:"my-card q-py-md",attrs:{flat:"",bordered:""}},[a("q-form",{staticClass:"q-gutter-xl"},[a("h5",{staticClass:"text-center q-pt-md"},[e._v("新增商品")]),a("q-card-section",[a("q-input",{attrs:{filled:"",label:"商品名稱"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("q-card-section",[a("q-input",{attrs:{filled:"",label:"商品說明",type:"textarea"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("q-card-section",[a("q-input",{attrs:{filled:"",label:"商品規格",type:"textarea"},model:{value:e.form.detail,callback:function(t){e.$set(e.form,"detail",t)},expression:"form.detail"}})],1),a("q-card-section",[a("q-input",{attrs:{filled:"",label:"商品價格",type:"number"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),a("q-card-section",[a("div",{staticClass:"q-gutter-xl text-center"},[a("img-inputer",{attrs:{theme:"dark",size:"large",placeholder:"點擊或拖曳選擇圖片","bottom-text":"點擊或拖曳以修改"},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1)]),a("q-card-section",[a("q-select",{attrs:{outlined:"",options:e.brand,label:"商品品牌"},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}})],1),a("q-card-section",[a("q-select",{attrs:{outlined:"",options:e.cate,label:"商品類別"},model:{value:e.form.cate,callback:function(t){e.$set(e.form,"cate",t)},expression:"form.cate"}})],1),a("q-card-section",[a("q-td",{key:"sell"}),a("div",{staticClass:"text-center"},[a("q-toggle",{attrs:{label:"是否上架"},model:{value:e.form.sell,callback:function(t){e.$set(e.form,"sell",t)},expression:"form.sell"}})],1)],1),a("q-card-section",[a("div",{staticClass:"text-center"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",outline:""},on:{click:e.submitModal}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{label:"重寫",type:"reset",outline:""},on:{click:e.reset}})],1)])],1)],1)],1),a("q-input",{attrs:{id:"search",borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0}])})],1)])])},o=[],s=a("c973"),i=a.n(s),l=(a("96cf"),a("b0c0"),a("a4d3"),a("e01a"),a("99af"),a("d81d"),{name:"AdminProductManage",data:function(){return{add:!1,edit:!1,submitDisable:!1,loading:!1,filter:"",brand:["華碩","技嘉","微星"],cate:["主機板","顯示卡","筆記型電腦","套裝電腦"],products:[],columns:[{name:"name",label:"商品名稱",align:"center",sortable:!0,field:function(e){return e.name},format:function(e){return"".concat(e)}},{name:"description",align:"center",label:"商品說明",field:"description",sortable:!1,style:"width:500px"},{name:"detail",align:"center",label:"商品規格",field:"detail",sortable:!1,style:"width:500px"},{name:"price",align:"center",label:"商品價格",field:"price",sortable:!0},{name:"brand",align:"center",label:"商品品牌",field:"brand",sortable:!0},{name:"cate",align:"center",label:"商品類別",field:"cate",sortable:!0},{name:"image",align:"center",label:"商品圖片",field:"image",sortable:!1},{name:"sell",label:"商品上架",align:"center",field:"sell",sortable:!0}],form:{name:"",price:0,description:"",detail:"",image:"null",brand:"",cate:"",sell:!0,_id:""}}},methods:{submitModal:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var a,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r in e.submitDisable=!0,t.prev=1,a=new FormData,e.form)a.append(r,e.form[r]);if(0!==e.form._id.length){t.next=10;break}return t.next=7,e.axios.post("/products",a,{headers:{authorization:"Bearer "+e.$store.state.user.jwt.token}});case 7:e.form={name:"",price:0,description:"",detail:"",image:"null",brand:"",cate:"",sell:!0,_id:""},t.next=23;break;case 10:return t.next=12,e.axios.patch("/products/"+e.form._id,a,{headers:{authorization:"Bearer "+e.$store.state.user.jwt.token}});case 12:o=t.sent,s=o.data,e.$set(e.products[e.form.index],"name",e.form.name),e.$set(e.products[e.form.index],"price",e.form.price),e.$set(e.products[e.form.index],"description",e.form.description),e.$set(e.products[e.form.index],"detail",e.form.detail),e.$set(e.products[e.form.index],"brand",e.form.brand),e.$set(e.products[e.form.index],"cate",e.form.cate),e.$set(e.products[e.form.index],"image","".concat("","/files/").concat(s.result.image)),e.$set(e.products[e.form.index],"sell",e.form.sell),e.$set(e.products[e.form.index],"_id",e.form._id);case 23:t.next=29;break;case 25:t.prev=25,t.t0=t["catch"](1),e.$swal({icon:"error",title:"上傳錯誤"}),console.log(t.t0);case 29:e.submitDisable=!1;case 30:case"end":return t.stop()}}),t,null,[[1,25]])})))()},editProduct:function(e){this.edit=!0,this.$set(this.form,"name",this.products[e].name),this.$set(this.form,"price",this.products[e].price),this.$set(this.form,"description",this.products[e].description),this.$set(this.form,"detail",this.products[e].detail),this.$set(this.form,"brand",this.products[e].brand),this.$set(this.form,"cate",this.products[e].cate),this.$set(this.form,"sell",this.products[e].sell),this.$set(this.form,"image",this.products[e].image),this.$set(this.form,"_id",this.products[e]._id),this.$set(this.form,"index",e),console.log(this.form)},reset:function(e){this.submitDisable?e.preventDefault():this.form={name:"",price:0,description:"",detail:"",image:"null",brand:"",cate:"",sell:!1,_id:""}}},mounted:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.axios.get("/products/all",{headers:{authorization:"Bearer "+e.$store.state.user.jwt.token}});case 3:a=t.sent,r=a.data,e.products=r.result.map((function(e){return e.image&&(e.image="".concat("","/files/").concat(e.image)),e})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"取得商品失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}),n=l,c=a("2877"),p=a("9989"),d=a("eaac"),u=a("bd08"),m=a("db86"),f=a("42a1"),b=a("0378"),v=a("27f9"),q=a("9c40"),x=a("ddd8"),w=a("6a67"),h=a("24e8"),k=a("f09f"),g=a("a370"),y=a("9564"),$=a("0016"),C=a("7f67"),_=a("eebe"),N=a.n(_),Q=Object(c["a"])(n,r,o,!1,null,null,null);t["default"]=Q.exports;N()(Q,"components",{QPage:p["a"],QTable:d["a"],QTr:u["a"],QTd:m["a"],QPopupEdit:f["a"],QForm:b["a"],QInput:v["a"],QBtn:q["a"],QSelect:x["a"],QBtnToggle:w["a"],QDialog:h["a"],QCard:k["a"],QCardSection:g["a"],QToggle:y["a"],QIcon:$["a"]}),N()(Q,"directives",{ClosePopup:C["a"]})}}]);