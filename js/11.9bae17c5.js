(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"89d4":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{staticClass:"q-pa-xl",attrs:{id:"userMemberManage"}},[r("q-table",{attrs:{title:"使用者管理",data:e.users,columns:e.columns,"row-key":"_id"},scopedSlots:e._u([{key:"body",fn:function(t){return[r("q-tr",{attrs:{props:t}},[r("q-td",{key:"account",attrs:{props:t}},[e._v(e._s(t.row.account))]),r("q-td",{key:"password",attrs:{props:t}},[e._v(e._s(t.row.password))]),r("q-td",{key:"email",attrs:{props:t}},[e._v(e._s(t.row.email))]),r("q-td",{key:"address",attrs:{props:t}},[e._v(e._s(t.row.address))]),r("q-td",{key:"image",attrs:{props:t}},[r("q-img",{staticStyle:{width:"100%"},attrs:{src:t.row.image}})],1),r("q-td",{key:"edit",attrs:{props:t}},[r("q-btn-group",{attrs:{outline:""}},[r("q-btn",{attrs:{outline:"",label:"編輯"},on:{click:function(r){return e.editProduct(t.rowIndex)}}}),r("q-dialog",{model:{value:e.edit,callback:function(t){e.edit=t},expression:"edit"}},[r("q-card",{staticClass:"my-card q-py-md",attrs:{flat:"",bordered:""}},[r("q-form",{staticClass:"q-gutter-xl"},[r("h5",{staticClass:"text-center q-pt-md"},[e._v("編輯使用者")]),r("q-card-section",[r("q-input",{attrs:{filled:"",label:"使用者帳號",required:"",hint:"可以使用",error:!e.state.account,"error-message":"帳號長度請在 4 ~ 20 個字之間"},model:{value:e.form.account,callback:function(t){e.$set(e.form,"account",t)},expression:"form.account"}})],1),r("q-card-section",[r("q-input",{attrs:{filled:"",label:"使用者密碼",hint:"可以使用",error:!e.state.password,"error-message":"密碼長度請在 4 ~ 20 個字之間"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),r("q-card-section",[r("q-input",{attrs:{filled:"",label:"使用者信箱",required:"",error:!e.state.email,"error-message":"請輸入正確的信箱格式"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),r("q-card-section",[r("q-input",{attrs:{filled:"",label:"使用者地址"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),r("q-card-section",[r("div",{staticClass:"q-gutter-xl text-center"},[r("img-inputer",{attrs:{theme:"dark",size:"large",placeholder:"點擊或拖曳上傳使用者頭像","bottom-text":"點擊或拖曳以修改"},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1)]),r("q-card-section",[r("div",{staticClass:"text-center"},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"送出",type:"submit",color:"primary"},on:{click:e.submitModal}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-sm",attrs:{label:"關閉",type:"reset",color:"primary",flat:""}})],1)])],1)],1)],1)],1)],1)],1)]}}])})],1)},a=[],o=r("c973"),i=r.n(o),n=(r("96cf"),r("99af"),r("edd5")),l={name:"UserMemberManage",data:function(){return{users:[],edit:!1,form:{account:"",password:"",email:"",address:"",image:"null",role:""},columns:[{name:"account",required:!0,label:"使用者名稱",align:"center",field:"account",sortable:!0},{name:"password",align:"center",label:"使用者密碼",field:"password",sortable:!0},{name:"email",align:"center",label:"使用者信箱",field:"email",sortable:!0},{name:"address",label:"收貨地址",field:"address",align:"center"},{name:"image",label:"使用者頭像",field:"image",align:"center"},{name:"edit",label:"使用者管理",field:"edit",align:"center"}]}},computed:{state:function(){var e=this.form.account,t=this.form.password,r=this.form.email;return{account:0===e.length?null:e.length>=4&&e.length<=20,password:0===t.length?null:t.length>=4&&t.length<=20,email:0===r.length?null:Object(n["a"])(r)}}},methods:{editProduct:function(e){this.edit=!0,this.$set(this.form,"account",this.users[e].account),this.$set(this.form,"email",this.users[e].email),this.$set(this.form,"address",this.users[e].address),this.$set(this.form,"image",this.users[e].image),this.$set(this.form,"role",this.users[e].role),this.$set(this.form,"_id",this.users[e]._id),this.$set(this.form,"index",e)},submitModal:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var r,s,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(s in t.prev=0,r=new FormData,e.form)r.append(s,e.form[s]);return t.next=5,e.axios.patch("/users/edit"+e.form._id,r,{headers:{authorization:"Bearer "+e.$store.state.user.jwt.token}});case 5:a=t.sent,o=a.data,e.$set(e.users[e.form.index],"account",e.form.account),e.$set(e.users[e.form.index],"password",e.form.password),e.$set(e.users[e.form.index],"email",e.form.email),e.$set(e.users[e.form.index],"address",e.form.address),e.$set(e.users[e.form.index],"image","".concat("https://renly-eshop.herokuapp.com","/files/").concat(o.result.image)),e.$set(e.users[e.form.index],"role",e.form.role),e.$set(e.users[e.form.index],"_id",e.form._id),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](0),e.$swal({icon:"error",title:"上傳錯誤"}),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,16]])})))()}},mounted:function(){var e=this;return i()(regeneratorRuntime.mark((function t(){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.axios.get("/users",{headers:{authorization:"Bearer "+e.$store.state.user.jwt.token}});case 2:r=t.sent,s=r.data,s.result.image="http://localhost:3000/files/".concat(s.result.image),e.users.push(s.result);case 6:case"end":return t.stop()}}),t)})))()}},c=l,d=r("2877"),u=r("9989"),m=r("eaac"),p=r("bd08"),f=r("db86"),h=r("068f"),g=r("e7a9"),b=r("9c40"),w=r("24e8"),q=r("f09f"),x=r("0378"),v=r("a370"),k=r("27f9"),$=r("7f67"),_=r("eebe"),y=r.n(_),Q=Object(d["a"])(c,s,a,!1,null,null,null);t["default"]=Q.exports;y()(Q,"components",{QPage:u["a"],QTable:m["a"],QTr:p["a"],QTd:f["a"],QImg:h["a"],QBtnGroup:g["a"],QBtn:b["a"],QDialog:w["a"],QCard:q["a"],QForm:x["a"],QCardSection:v["a"],QInput:k["a"]}),y()(Q,"directives",{ClosePopup:$["a"]})}}]);